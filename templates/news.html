{# templates/news.html #}

{% extends "_template.html" %}

{% block title %}News{% endblock title %}

{% block content %}
                <div class="row">
                    <h3>{{ title }}</h3>
                    <p>{{ intro }}</p>
                    <p>{{ content }}</p>
                    {% for year, items in news
                      |sort(attribute="date", reverse=True)
                      |groupby("date.year")
                      |sort(attribute="grouper", reverse=True) %}
                      <div class="mb-3">
                        <!-- Year toggle -->
                        <button class="btn btn-primary w-100 text-start"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#collapse-{{ year }}"
                            aria-expanded="{% if loop.first %}true{% else %}false{% endif %}"
                            aria-controls="collapse-{{ year }}">
                          {{ year }}
                        </button>

                        <!-- News block for this year -->
                        <div class="collapse mt-2 {% if loop.first %}show{% endif %}" id="collapse-{{ year }}">
                          {% for item in items %}
                          <div class="col-12 mb-3">
                            <h5 tabindex="0"><strong>{{ item.date }}</strong> - {{ item.title }}</h5>

                            <!-- Small screens -->
                            <div class="d-md-none">
                              <div class="row overflow-x-auto">
                                {% if item.img is not none %}
                                <div class="col-12 text-center">
                                  <a href="{% if item.img.startswith('http') %}{{ item.img }}{% else %}{{ static_url }}/img/{{ item.img }}{% endif %}">
                                    <img class="img-responsive rounded mx-auto d-block"
                                         src="{% if item.img.startswith('http') %}{{ item.img }}{% else %}{{ static_url }}/img/{{ item.img }}{% endif %}"
                                         alt="{{ item.img_alt }}"
                                         tabindex="0"
                                         style="max-width: 100%; height: auto;">
                                  </a>
                                </div>
                                {% endif %}

                                {% if item.description is not none %}
                                <div class="col-12">
                                  <p class="mb-0">{{ item.description }}</p>
                                </div>
                                {% endif %}
                              </div>
                            </div>

                            <!-- Larger screens -->
                            <div class="col-12 d-none d-md-block">
                              <div class="row overflow-x-auto">
                                {% if item.img is not none %}
                                <div class="col-6 col-md-3 text-center">
                                  <a href="{% if item.img.startswith('http') %}{{ item.img }}{% else %}{{ static_url }}/img/{{ item.img }}{% endif %}">
                                    <img class="img-responsive rounded"
                                         src="{% if item.img.startswith('http') %}{{ item.img }}{% else %}{{ static_url }}/img/{{ item.img }}{% endif %}"
                                         alt="{{ item.img_alt }}"
                                         tabindex="0"
                                         style="max-width: 100%; height: auto;">
                                  </a>
                                </div>
                                {% endif %}

                                {% if item.description is not none %}
                                {% if item.img is not none %}
                                <div class="col-6 col-md-9">
                                {% else %}
                                <div class="col-12">
                                {% endif %}
                                  <p class="mb-0">{{ item.description }}</p>
                                </div>
                                {% endif %}
                              </div>
                            </div>

                          </div>
                          {% endfor %}
                        </div>
                      </div>
                    {% endfor %}
                    <p>{{ outro }}</p>
                </div>
{% endblock content %}
